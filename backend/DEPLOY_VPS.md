# üöÄ –î–µ–ø–ª–æ–π Backend –Ω–∞ VPS

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VPS

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∞—à–µ–º—É VPS
ssh user@your-server-ip

# –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
sudo apt update && sudo apt upgrade -y
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.11+
sudo apt install python3.11 python3.11-venv python3-pip -y

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Git
sudo apt install git -y

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
sudo apt install nginx -y
```

### 3. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/your-username/career-miniapp.git
cd career-miniapp/backend
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3.11 -m venv venv
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª
cp .env.example .env
nano .env
```

```env
# –°–æ–¥–µ—Ä–∂–∏–º–æ–µ .env —Ñ–∞–π–ª–∞
OPENAI_API_KEY=your_openai_api_key_here
ALLOWED_ORIGINS=https://your-domain.com,https://t.me
ENVIRONMENT=production
HOST=0.0.0.0
PORT=8000
```

### 5. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫
uvicorn main:app --host 0.0.0.0 --port 8000

# –°–æ–∑–¥–∞–π—Ç–µ systemd —Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
sudo nano /etc/systemd/system/career-backend.service
```

```ini
[Unit]
Description=Career Backend API
After=network.target

[Service]
Type=simple
User=your-username
WorkingDirectory=/home/your-username/career-miniapp/backend
Environment=PATH=/home/your-username/career-miniapp/backend/venv/bin
ExecStart=/home/your-username/career-miniapp/backend/venv/bin/uvicorn main:app --host 0.0.0.0 --port 8000
Restart=always

[Install]
WantedBy=multi-user.target
```

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
sudo systemctl daemon-reload
sudo systemctl enable career-backend
sudo systemctl start career-backend
```

### 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx
sudo nano /etc/nginx/sites-available/career-backend
```

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo ln -s /etc/nginx/sites-available/career-backend /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
curl http://your-server-ip/health
```

## üîß –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –æ–±–Ω–æ–≤–∏—Ç–µ `.env.local` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
NEXT_PUBLIC_API_URL=http://your-server-ip:8000
# –ò–ª–∏ —Å –¥–æ–º–µ–Ω–æ–º:
# NEXT_PUBLIC_API_URL=https://your-domain.com
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **–õ–æ–≥–∏**: `sudo journalctl -u career-backend -f`
- **–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞**: `sudo systemctl status career-backend`
- **Health check**: `curl http://your-server-ip:8000/health`
- **API docs**: `http://your-server-ip:8000/docs`

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh user@your-server-ip
cd career-miniapp

# –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥
git pull origin main
cd backend

# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
source venv/bin/activate
pip install -r requirements.txt

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
sudo systemctl restart career-backend
```

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
sudo systemctl restart career-backend

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo journalctl -u career-backend -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
sudo systemctl status career-backend

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞/–∑–∞–ø—É—Å–∫
sudo systemctl stop career-backend
sudo systemctl start career-backend

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
sudo netstat -tlnp | grep :8000
```

## üí∞ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ VPS

VPS –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–µ—Ä–≤–µ—Ä–æ–º
- –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –±–µ–∑ –∑–∞—Å—ã–ø–∞–Ω–∏—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥ –≤–∞—à–∏ –Ω—É–∂–¥—ã
- –ë–æ–ª–µ–µ –Ω–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall: `sudo ufw enable && sudo ufw allow 22,80,443,8000/tcp`
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ .env —Ñ–∞–π–ª–µ
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É: `sudo apt update && sudo apt upgrade`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (Let's Encrypt)

## üö® Troubleshooting

### –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
sudo journalctl -u career-backend -n 50
sudo systemctl status career-backend
```

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
```bash
sudo systemctl restart career-backend
sudo netstat -tlnp | grep :8000
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å CORS
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª:
```bash
cat .env | grep ALLOWED_ORIGINS
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—Ä—Ç–∞–º–∏
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç —Å–≤–æ–±–æ–¥–µ–Ω
sudo lsof -i :8000
# –£–±–µ–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
sudo kill -9 PID
```